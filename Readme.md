# praktikum-kafka

## Описание работы приложения
Приложение автоматически созадет топик с 3 партициями и 2 репликами (если нужно это сделать вручную, то соответствующая команда лежит в файле topic.txt)

Приложение, состоит из 1 продюсера и 2 консьюмеров.

Продюсер отправляет сообщения в Kafka-топик (модель push) один раз в секунду.

Первый консьюмер (SingleMessageConsumer) считывает по одному сообщению, обрабатывает его и коммитит оффсет автоматически.

Второй консьюмер (BatchMessageConsumer) считывает минимум по 10 сообщений за один poll, обрабатывает сообщения в цикле и один раз коммитит оффсет после обработки пачки.

## Более детальное описание работы компонентов

### KafkaTopicConfiguration
Компонент автоматически создает Kafka-топик при запуске приложения. Он читает настройки подключения из конфигурации, пытается создать топик с заданным количеством разделов и реплик, и обрабатывает ситуацию, когда топик уже существует, логируя соответствующие сообщения об успехе или ошибке.

### ProducerComponent
Компонент отвечает за отправку сообщений в Kafka-топик. При инициализации он настраивает и создает продюсера с указанными параметрами подключения, а каждую секунду с помощью шедулера генерирует и отправляет случайные погодные данные в топик, используя вспомогательный класс для сериализации. При завершении работы приложения продюсер корректно закрывается.

### SingleMessageConsumer
Компонент запускает Kafka-консьюмера при старте приложения, который подписывается на топик и потребляет сообщения по одному за раз с настройками автоматического коммита и ограничением на получение одной записи за один poll-запрос, используя общий runner для обработки сообщений.

### BatchMessageConsumer
Компонент запускает пакетного Kafka-консьюмера, который настраивается для накопления сообщений с отключенным авто-коммитом и увеличенным временем ожидания данных, чтобы обрабатывать сообщения пачками через общий runner с ручным подтверждением получения.

## Java
Приложение запускается на версии Java 21

## Kafka
Для работы необходим брокер сообщений **Kafka**

## Maven
При разработке приложения использовался Maven версии 3.9.9

## Сборка
Для сборки проекта необходимо запустить команду
```
mvn clean package
```
## Запуск веб-приложения в Docker
Для запуска приложения необходимо из дирректории /docker проекта запустить следующую команду:

```
docker-compose -p kafka-app -f .\app.yaml up -d --build
```
## Проверка работоспособности
После запуска приложения в логах соответствующего контейнера можно увидеть информацию об отправленных и полученных сообщениях.
